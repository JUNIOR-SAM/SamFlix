<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SamFlix ‚Äî Favorites</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="bootstrap.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
</head>
<body class="bg-gray-900 text-white min-h-screen">
  <header class="bg-gray-800 py-4 shadow-md">
    <div class="max-w-6xl mx-auto flex justify-between items-center px-4">
      <h1 class="text-2xl font-bold text-red-500 cursor-pointer" onclick="window.location.href='dashboard.html'">üé¨ SamFlix</h1>
      <button onclick="window.location.href='dashboard.html'" class="bg-gray-700 px-4 py-2 rounded hover:bg-gray-600 transition">‚Üê Back</button>
    </div>
  </header>

  <main class="max-w-6xl mx-auto mt-6 px-3">
    <h2 class="text-xl font-semibold mb-4">‚ù§Ô∏è Your Favorite Shows</h2>
    <div id="favoritesContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-3"></div>
  </main>

  <footer class="text-center py-6 text-gray-400 text-sm border-t border-gray-700 mt-8">
    ¬© 2025 SamFlix | Built by <span class="text-red-500 font-semibold">Samuel</span> üçø
  </footer>

<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
 <script>
  const favoritesContainer = document.getElementById("favoritesContainer");
  let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

  // ‚úÖ Toast function
  function toast(text, type = "info") {
    if (typeof Toastify === "function") {
      Toastify({
        text,
        duration: 2000,
        gravity: "top",
        position: "center",
        style: {
          background:
            type === "success"
              ? "#10b981"
              : type === "error"
              ? "#ef4444"
              : "#3b82f6",
          borderRadius: "10px"
        }
      }).showToast();
    } else {
      alert(text);
    }
  }

  function renderFavorites() {
    favoritesContainer.innerHTML = "";
    if (favorites.length === 0) {
      favoritesContainer.innerHTML = `<p class="text-center text-gray-400 col-span-full">No favorites added yet.</p>`;
      return;
    }

    favorites.forEach(show => {
      const card = document.createElement("div");
      card.className = "bg-gray-800 rounded-lg overflow-hidden shadow-lg hover:scale-105 transition cursor-pointer";
      card.innerHTML = `
        <img src="${show.image || 'https://via.placeholder.com/300x420?text=No+Image'}" alt="${escapeHtml(show.name)}" class="w-full h-64 object-cover">
        <div class="p-3">
          <h3 class="text-lg font-semibold mb-1">${escapeHtml(show.name)}</h3>
          <p class="text-sm text-gray-400">${(show.genres && show.genres.join(", ")) || ''}</p>
          <div class="mt-2 flex= gap-2">
            <div class="d-flex justify-content-end col-12">
              <button class="remove-btn bg-red-600 px-2 py-2 col-6 rounded text-sm">Remove</button>
            </div>
          </div>
        </div>
      `;

      // ‚úÖ Replace alert with toast
      card.querySelector(".remove-btn").addEventListener("click", () => {
        favorites = favorites.filter(f => f.id !== show.id);
        localStorage.setItem("favorites", JSON.stringify(favorites));
        toast(`Removed "${show.name}" from Favorites ‚ùå`, "error");
        renderFavorites();
      });

      favoritesContainer.appendChild(card);
    });
  }

  function escapeHtml(text = "") {
    return String(text)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;");
  }

  renderFavorites();

  // sync updates
  window.addEventListener("storage", (e) => {
    if (e.key === "favorites") {
      favorites = JSON.parse(e.newValue) || [];
      renderFavorites();
    }
  });
</script>

</body>
</html>
